[2025-12-05 13:53:50] [INFO] ================================================================================
[2025-12-05 13:53:50] [INFO] ЗАПУСК ОБУЧЕНИЯ МОДЕЛИ
[2025-12-05 13:53:50] [INFO] ================================================================================
[2025-12-05 13:53:50] [INFO] СИСТЕМНАЯ ИНФОРМАЦИЯ:
[2025-12-05 13:53:51] [INFO] CPU: 12 cores, Использование: 2.7%
RAM: Всего: 15.2GB, Используется: 60.9%, Свободно: 6.0GB
GPU: 1 устройств(а)
  GPU 0: NVIDIA GeForce RTX 4050 Laptop GPU, Память: 6.0GB
[2025-12-05 13:53:51] [INFO] Начало: Загрузка данных
[2025-12-05 13:53:51] [INFO] Загружен датасет из data/processed
[2025-12-05 13:53:51] [INFO] Количество примеров: 26405
[2025-12-05 13:53:51] [INFO] Колонки датасета: ['input', 'target']
[2025-12-05 13:53:51] [INFO] Завершено: Загрузка данных | Затрачено времени: 0.02 секунд (0:00:00)
[2025-12-05 13:53:51] [INFO] Начало: Загрузка токенизатора
[2025-12-05 13:53:52] [INFO] Токенизатор загружен: google/flan-t5-small
[2025-12-05 13:53:52] [INFO] Размер словаря: 32100
[2025-12-05 13:53:52] [INFO] Завершено: Загрузка токенизатора | Затрачено времени: 1.18 секунд (0:00:01)
[2025-12-05 13:53:52] [INFO] Начало: Токенизация данных
[2025-12-05 13:54:01] [INFO] Токенизация завершена. Размер: 26405
[2025-12-05 13:54:01] [INFO] Завершено: Токенизация данных | Затрачено времени: 9.16 секунд (0:00:09)
[2025-12-05 13:54:01] [INFO] Начало: Загрузка модели
[2025-12-05 13:54:01] [INFO] Загрузка модели в 8-bit режиме...
[2025-12-05 13:54:03] [INFO] Модель подготовлена для k-bit обучения
[2025-12-05 13:54:03] [INFO] Завершено: Загрузка модели | Затрачено времени: 1.94 секунд (0:00:01)
[2025-12-05 13:54:03] [INFO] Начало: Настройка LoRA
[2025-12-05 13:54:03] [INFO] LoRA конфигурация применена
[2025-12-05 13:54:03] [INFO] Всего параметров: 79,123,840
[2025-12-05 13:54:03] [INFO] Обучаемых параметров (LoRA): 2,162,688 (2.73%)
[2025-12-05 13:54:03] [INFO] Завершено: Настройка LoRA | Затрачено времени: 0.11 секунд (0:00:00)
[2025-12-05 13:54:03] [INFO] ================================================================================
ПАРАМЕТРЫ ОБУЧЕНИЯ
================================================================================
Модель: google/flan-t5-small
Устройство: cuda
8-bit обучение: True
Размер батча: 8
Эпохи: 3
Learning rate: 0.0003
Макс. длина входных данных: 256
Макс. длина целевых данных: 128
Размер обучающего набора: 26405 примеров
Всего параметров модели: 79,123,840
Обучаемых параметров: 2,162,688 (2.73%)
Необучаемых параметров: 76,961,152
================================================================================
[2025-12-05 13:54:05] [INFO] ================================================================================
[2025-12-05 13:54:05] [INFO] НАЧАЛО ОБУЧЕНИЯ МОДЕЛИ
[2025-12-05 13:54:05] [INFO] ================================================================================
[2025-12-05 13:54:05] [INFO] Начало: Обучение модели
[2025-12-05 13:55:34] [INFO] Шаг 100: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.060587700696758555}
[2025-12-05 13:57:04] [INFO] Шаг 200: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.12117540139351711}
[2025-12-05 13:58:33] [INFO] Шаг 300: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.18176310209027569}
[2025-12-05 14:00:03] [INFO] Шаг 400: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.24235080278703422}
[2025-12-05 14:01:32] [INFO] Шаг 500: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.3029385034837928}
[2025-12-05 14:03:01] [INFO] Шаг 600: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.36352620418055137}
[2025-12-05 14:04:30] [INFO] Шаг 700: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.42411390487730993}
[2025-12-05 14:05:59] [INFO] Шаг 800: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.48470160557406844}
[2025-12-05 14:07:28] [INFO] Шаг 900: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.5452893062708271}
[2025-12-05 14:08:57] [INFO] Шаг 1000: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.6058770069675856}
[2025-12-05 14:10:28] [INFO] Шаг 1100: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.6664647076643442}
[2025-12-05 14:11:57] [INFO] Шаг 1200: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.7270524083611027}
[2025-12-05 14:13:25] [INFO] Шаг 1300: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.7876401090578613}
[2025-12-05 14:14:55] [INFO] Шаг 1400: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.8482278097546199}
[2025-12-05 14:16:24] [INFO] Шаг 1500: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.9088155104513783}
[2025-12-05 14:17:52] [INFO] Шаг 1600: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 0.9694032111481369}
[2025-12-05 14:18:37] [INFO] Завершена эпоха 1.0/3
[2025-12-05 14:18:37] [INFO] GPU 0 память: выделено 0.21GB, зарезервировано 0.76GB
[2025-12-05 14:18:37] [INFO] CPU использование: 19.4%, RAM использование: 66.4%
[2025-12-05 14:21:43] [INFO] Шаг 1651: {'eval_loss': nan, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_runtime': 186.0575, 'eval_samples_per_second': 5.375, 'eval_steps_per_second': 0.672, 'epoch': 1.0}
[2025-12-05 14:22:29] [INFO] Шаг 1700: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.0296879733414117}
[2025-12-05 14:23:59] [INFO] Шаг 1800: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.0902756740381703}
[2025-12-05 14:25:28] [INFO] Шаг 1900: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.1508633747349288}
[2025-12-05 14:26:58] [INFO] Шаг 2000: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.2114510754316874}
[2025-12-05 14:28:26] [INFO] Шаг 2100: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.272038776128446}
[2025-12-05 14:29:56] [INFO] Шаг 2200: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.3326264768252045}
[2025-12-05 14:31:25] [INFO] Шаг 2300: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.393214177521963}
[2025-12-05 14:32:54] [INFO] Шаг 2400: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.4538018782187216}
[2025-12-05 14:34:23] [INFO] Шаг 2500: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.5143895789154802}
[2025-12-05 14:35:54] [INFO] Шаг 2600: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.5749772796122388}
[2025-12-05 14:37:20] [INFO] Шаг 2700: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.635564980308997}
[2025-12-05 14:38:45] [INFO] Шаг 2800: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.696152681005756}
[2025-12-05 14:40:12] [INFO] Шаг 2900: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.7567403817025142}
[2025-12-05 14:41:40] [INFO] Шаг 3000: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.817328082399273}
[2025-12-05 14:43:08] [INFO] Шаг 3100: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.8779157830960314}
[2025-12-05 14:44:37] [INFO] Шаг 3200: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.9385034837927901}
[2025-12-05 14:46:05] [INFO] Шаг 3300: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 1.9990911844895485}
[2025-12-05 14:46:07] [INFO] Завершена эпоха 2.0/3
[2025-12-05 14:46:07] [INFO] GPU 0 память: выделено 0.21GB, зарезервировано 0.76GB
[2025-12-05 14:46:07] [INFO] CPU использование: 19.0%, RAM использование: 66.5%
[2025-12-05 14:49:09] [INFO] Шаг 3302: {'eval_loss': nan, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_runtime': 182.6403, 'eval_samples_per_second': 5.475, 'eval_steps_per_second': 0.684, 'epoch': 2.0}
[2025-12-05 14:50:37] [INFO] Шаг 3400: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.0593759466828234}
[2025-12-05 14:52:05] [INFO] Шаг 3500: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.1199636473795818}
[2025-12-05 14:53:33] [INFO] Шаг 3600: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.1805513480763405}
[2025-12-05 14:55:02] [INFO] Шаг 3700: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.241139048773099}
[2025-12-05 14:56:30] [INFO] Шаг 3800: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.3017267494698577}
[2025-12-05 14:57:57] [INFO] Шаг 3900: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.362314450166616}
[2025-12-05 14:59:26] [INFO] Шаг 4000: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.422902150863375}
[2025-12-05 15:01:03] [INFO] Шаг 4100: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.483489851560133}
[2025-12-05 15:02:31] [INFO] Шаг 4200: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.544077552256892}
[2025-12-05 15:04:00] [INFO] Шаг 4300: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.6046652529536503}
[2025-12-05 15:05:28] [INFO] Шаг 4400: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.665252953650409}
[2025-12-05 15:06:56] [INFO] Шаг 4500: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.7258406543471674}
[2025-12-05 15:08:24] [INFO] Шаг 4600: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.786428355043926}
[2025-12-05 15:09:53] [INFO] Шаг 4700: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.8470160557406845}
[2025-12-05 15:11:21] [INFO] Шаг 4800: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.9076037564374433}
[2025-12-05 15:12:49] [INFO] Шаг 4900: {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0003, 'epoch': 2.9681914571342016}
[2025-12-05 15:13:35] [INFO] Завершена эпоха 3.0/3
[2025-12-05 15:13:35] [INFO] GPU 0 память: выделено 0.21GB, зарезервировано 0.76GB
[2025-12-05 15:13:35] [INFO] CPU использование: 18.5%, RAM использование: 65.8%
[2025-12-05 15:17:03] [INFO] Шаг 4953: {'eval_loss': nan, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_runtime': 207.3932, 'eval_samples_per_second': 4.822, 'eval_steps_per_second': 0.603, 'epoch': 3.0}
[2025-12-05 15:17:04] [INFO] Шаг 4953: {'train_runtime': 4978.4705, 'train_samples_per_second': 15.912, 'train_steps_per_second': 0.995, 'total_flos': 7625801583820800.0, 'train_loss': 0.0, 'epoch': 3.0}
[2025-12-05 15:17:04] [INFO] Общее время обучения: 4978.47 секунд
[2025-12-05 15:17:04] [INFO] Общее количество шагов: 4953
[2025-12-05 15:17:04] [INFO] Завершено: Обучение модели | Затрачено времени: 4978.69 секунд (1:22:58)
[2025-12-05 15:17:04] [INFO] ================================================================================
[2025-12-05 15:17:04] [INFO] ОБУЧЕНИЕ ЗАВЕРШЕНО
[2025-12-05 15:17:04] [INFO] ================================================================================
[2025-12-05 15:17:04] [INFO] Общее время обучения: 4978.69 секунд
[2025-12-05 15:17:04] [INFO] Среднее время на эпоху: 1659.56 секунд
[2025-12-05 15:17:04] [INFO] Выполнение финальной оценки...
[2025-12-05 15:20:08] [INFO] Шаг 4953: {'eval_loss': nan, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_runtime': 184.64, 'eval_samples_per_second': 5.416, 'eval_steps_per_second': 0.677, 'epoch': 3.0}
[2025-12-05 15:20:08] [INFO] Финальные метрики: {'eval_loss': nan, 'eval_rouge1': 0.0, 'eval_rouge2': 0.0, 'eval_rougeL': 0.0, 'eval_rougeLsum': 0.0, 'eval_runtime': 184.64, 'eval_samples_per_second': 5.416, 'eval_steps_per_second': 0.677, 'epoch': 3.0}
[2025-12-05 15:20:08] [INFO] Сохранение лучшей модели...
[2025-12-05 15:20:09] [INFO] Память GPU очищена
[2025-12-05 15:20:09] [INFO] Начало: Сохранение модели и токенизатора
[2025-12-05 15:20:10] [INFO] Веса PEFT сохранены в saved_model
[2025-12-05 15:20:10] [INFO] Токенизатор сохранен в saved_model
[2025-12-05 15:20:10] [INFO] Конфигурация обучения сохранена в saved_model\training_config.json
[2025-12-05 15:20:10] [INFO] Завершено: Сохранение модели и токенизатора | Затрачено времени: 0.60 секунд (0:00:00)
[2025-12-05 15:20:10] [INFO] ================================================================================
[2025-12-05 15:20:10] [INFO] ОБУЧЕНИЕ УСПЕШНО ЗАВЕРШЕНО!
[2025-12-05 15:20:10] [INFO] Модель сохранена в: saved_model
[2025-12-05 15:20:10] [INFO] Логи сохранены в: training_logs\training_log_20251205_135350.txt
[2025-12-05 15:20:10] [INFO] ================================================================================
